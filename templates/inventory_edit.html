{% extends "base.html" %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
    <h2>Edit Inventory Item</h2>
    <a href="{{ url_for('inventory_detail', id=item.id) }}" class="btn btn-secondary">Cancel</a>
</div>

<form method="POST" class="card">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    
    <div class="form-group">
        <label for="item_name">Item Name *</label>
        <input type="text" id="item_name" name="item_name" value="{{ item.item_name }}" required class="form-control">
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        <div class="form-group">
            <label for="category">Category *</label>
            <select id="category" name="category" class="form-control" required>
                <option value="cat" {{ 'selected' if item.category == 'cat' else '' }}>Cat Supplies</option>
                <option value="dog" {{ 'selected' if item.category == 'dog' else '' }}>Dog Supplies</option>
                <option value="general" {{ 'selected' if item.category == 'general' else '' }}>General</option>
                <option value="medical" {{ 'selected' if item.category == 'medical' else '' }}>Medical</option>
                <option value="cleaning" {{ 'selected' if item.category == 'cleaning' else '' }}>Cleaning</option>
                <option value="food" {{ 'selected' if item.category == 'food' else '' }}>Food</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="quantity">Current Quantity *</label>
            <input type="number" id="quantity" name="quantity" value="{{ item.quantity }}" class="form-control" required>
            <small style="color: #7f8c8d;">Use transactions for adjustments instead of editing directly</small>
        </div>
        
        <div class="form-group">
            <label for="unit">Unit</label>
            <input type="text" id="unit" name="unit" value="{{ item.unit }}" class="form-control" placeholder="e.g., bags, bottles, boxes">
        </div>
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        <div class="form-group">
            <label for="location">Storage Location</label>
            <input type="text" id="location" name="location" value="{{ item.location }}" class="form-control" placeholder="e.g., Cabinet A, Shelf 2">
        </div>
        
        <div class="form-group">
            <label for="reorder_point">Reorder Point</label>
            <input type="number" id="reorder_point" name="reorder_point" value="{{ item.reorder_point }}" class="form-control" placeholder="Alert when stock falls below this">
        </div>
    </div>
    
    <div class="form-group">
        <label for="notes">Notes</label>
        <textarea id="notes" name="notes" class="form-control" rows="3">{{ item.notes }}</textarea>
    </div>
    
    <button type="submit" class="btn btn-success">Save Changes</button>
    <a href="{{ url_for('inventory_detail', id=item.id) }}" class="btn btn-secondary">Cancel</a>
</form>

{% if current_user.role in ['admin', 'management'] %}
<div class="card" style="margin-top: 1.5rem; border-left: 3px solid #e74c3c;">
    <h3 style="color: #e74c3c;">Danger Zone</h3>
    <p>Deleting this item will remove all transaction history. This action cannot be undone.</p>
    <form method="POST" action="{{ url_for('inventory_delete', id=item.id) }}" onsubmit="return confirm('Are you sure you want to delete this inventory item? All transaction history will be lost.');">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <button type="submit" class="btn btn-danger">Delete Item</button>
    </form>
</div>
{% endif %}
{% endblock %}
